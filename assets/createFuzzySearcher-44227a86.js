import{c as Z,g as U,a as q}from"./config-f4a827eb.js";var H={exports:{}};(function(m){(function(x,k){m.exports?m.exports=k():x.fuzzysort=k()})(Z,function(){function k(u){var f={single:function(n,e,r){if(n=="farzher")return{target:"farzher was here (^-^*)/",score:0,indexes:[0,1,2,3,4,5,6]};if(!n)return null;var a=f.getPreparedSearch(n),l=a.lowerCodes;if(!e)return null;F(e)||(e=f.getPrepared(e));var i=a.bitmask;return(i&e._bitmask)!=i?null:f.algorithm(l,e,n.toLowerCase())},go:function(n,e,r){if(n=="farzher")return[{target:"farzher was here (^-^*)/",score:0,indexes:[0,1,2,3,4,5,6],obj:e?e[0]:null}];if(!n)return r&&r.all||u&&u.all?f.all(n,e,r):B;var a=f.getPreparedSearch(n),l=a.lowerCodes;l[0];var i=a.bitmask,v=n.toLowerCase(),o=r&&r.threshold||u&&u.threshold||-9007199254740991,d=r&&r.limit||u&&u.limit||9007199254740991,t=0,s=0,S=e.length;if(r&&r.keys)for(var E=r.scoreFn||C,y=r.keys,T=y.length,p=S-1;p>=0;--p){for(var z=e[p],w=new Array(T),h=T-1;h>=0;--h){var N=y[h],c=j(z,N);if(!c){w[h]=null;continue}F(c)||(c=f.getPrepared(c)),(i&c._bitmask)!=i?w[h]=null:w[h]=f.algorithm(l,c,v)}w.obj=z;var A=E(w);A!==null&&(A<o||(w.score=A,t<d?(_.add(w),++t):(++s,A>_.peek().score&&_.replaceTop(w))))}else if(r&&r.key)for(var N=r.key,p=S-1;p>=0;--p){var z=e[p],c=j(z,N);if(c){if(F(c)||(c=f.getPrepared(c)),(i&c._bitmask)!=i)var g=null;else var g=f.algorithm(l,c,v);g!==null&&(g.score<o||(g={target:g.target,_targetLower:"",_targetLowerCodes:null,_nextBeginningIndexes:null,_bitmask:0,score:g.score,indexes:g.indexes,obj:z},t<d?(_.add(g),++t):(++s,g.score>_.peek().score&&_.replaceTop(g))))}}else for(var p=S-1;p>=0;--p){var c=e[p];if(c){if(F(c)||(c=f.getPrepared(c)),(i&c._bitmask)!=i)var g=null;else var g=f.algorithm(l,c,v);g!==null&&(g.score<o||(t<d?(_.add(g),++t):(++s,g.score>_.peek().score&&_.replaceTop(g))))}}if(t===0)return B;for(var $=new Array(t),p=t-1;p>=0;--p)$[p]=_.poll();return $.total=t+s,$},goAsync:function(n,e,r){var a=new Promise(function(l,i){l(f.go(n,e,r))});return a.cancel=function(){},a},all:function(n,e,r){var a=[];a.total=e.length;var l=r&&r.limit||u&&u.limit||9007199254740991;if(r&&r.keys)for(var i=0;i<e.length;i++){for(var v=e[i],o=new Array(r.keys.length),d=r.keys.length-1;d>=0;--d){var t=j(v,r.keys[d]);if(!t){o[d]=null;continue}F(t)||(t=f.getPrepared(t)),t.score=-9007199254740991,o[d]=t}if(o.obj=v,o.score=-9007199254740991,a.push(o),a.length>=l)return a}else if(r&&r.key)for(var i=0;i<e.length;i++){var v=e[i],t=j(v,r.key);if(t){F(t)||(t=f.getPrepared(t)),t.score=-9007199254740991;var s=t;if(s={target:s.target,_targetLower:"",_targetLowerCodes:null,_nextBeginningIndexes:null,_bitmask:0,score:t.score,indexes:null,obj:v},a.push(s),a.length>=l)return a}}else for(var i=0;i<e.length;i++){var t=e[i];if(t&&(F(t)||(t=f.getPrepared(t)),t.score=-9007199254740991,a.push(t),a.length>=l))return a}return a},highlight:function(n,e,r){if(typeof e=="function")return f.highlightCallback(n,e);if(n===null)return null;e===void 0&&(e="<b>"),r===void 0&&(r="</b>");for(var a="",l=0,i=!1,v=n.target,o=v.length,d=n.indexes,t=0;t<o;++t){var s=v[t];if(d[l]===t){if(++l,i||(i=!0,a+=e),l===d.length){a+=s+r+v.substr(t+1);break}}else i&&(i=!1,a+=r);a+=s}return a},highlightCallback:function(t,e){if(t===null)return null;for(var r=t.target,a=r.length,l=t.indexes,i="",v=0,o=0,d=!1,t=[],s=0;s<a;++s){var S=r[s];if(l[o]===s){if(++o,d||(d=!0,t.push(i),i=""),o===l.length){i+=S,t.push(e(i,v++)),i="",t.push(r.substr(s+1));break}}else d&&(d=!1,t.push(e(i,v++)),i="");i+=S}return t},prepare:function(n){n||(n="");var e=f.prepareLowerCodes(n);return{target:n,_targetLower:n.toLowerCase(),_targetLowerCodes:e,_nextBeginningIndexes:null,_bitmask:f.prepareBitmask(e),score:null,indexes:[0],obj:null}},prepareSlow:function(n){return f.prepare(n)},prepareSearch:function(n){n||(n="");var e=f.prepareLowerCodes(n);return{lowerCodes:e,bitmask:f.prepareBitmask(e)}},getPrepared:function(n){if(n.length>999)return f.prepare(n);var e=M.get(n);return e!==void 0||(e=f.prepare(n),M.set(n,e)),e},getPreparedSearch:function(n){if(n.length>999)return f.prepareSearch(n);var e=P.get(n);return e!==void 0||(e=f.prepareSearch(n),P.set(n,e)),e},algorithm:function(n,e,r){for(var a=n[0],l=e._targetLowerCodes,i=n.length,v=l.length,s=0,o=0,d=0;;){var t=a===l[o];if(t){if(b[d++]=o,++s,s===i)break;a=n[s]}if(++o,o>=v)return null}var s=0,S=!1,E=0,y=e._nextBeginningIndexes;y===null&&(y=e._nextBeginningIndexes=f.prepareNextBeginningIndexes(e.target)),o=b[0]===0?0:y[b[0]-1];var T=0;if(o!==v)for(;;)if(o>=v){if(s<=0||(++T,T>200))break;--s;var p=I[--E];o=y[p]}else{var t=n[s]===l[o];if(t){if(I[E++]=o,++s,s===i){S=!0;break}++o}else o=y[o]}var z=e._targetLower.indexOf(r,b[0]),w=~z;if(w&&!S)for(var h=0;h<d;++h)b[h]=z+h;var N=!1;w&&(N=e._nextBeginningIndexes[z-1]==z);{if(S)var c=I,A=E;else var c=b,A=d;for(var g=0,$=0,h=i-1;h>=1;--h)c[h]-c[h-1]!==1&&(g-=c[h],++$);var Y=c[i-1]-c[0]-(i-1);if(g-=Y*$,c[0]!==0&&(g-=c[0]*10),!S)g*=1e3;else{for(var K=1,h=y[0];h<v;h=y[h])++K;K>24&&(g*=(K-24)*10)}w&&(g/=10),N&&(g/=10),g-=v-i,e.score=g,e.indexes=new Array(A);for(var h=A-1;h>=0;--h)e.indexes[h]=c[h];return e}},prepareLowerCodes:function(n){for(var e=n.length,r=[],a=n.toLowerCase(),l=0;l<e;++l)r[l]=a.charCodeAt(l);return r},prepareBeginningIndexes:function(n){for(var e=n.length,r=[],a=0,l=!1,i=!1,v=0;v<e;++v){var o=n.charCodeAt(v),d=o>=65&&o<=90,t=d||o>=97&&o<=122||o>=48&&o<=57,s=d&&!l||!i||!t;l=d,i=t,s&&(r[a++]=v)}return r},prepareNextBeginningIndexes:function(n){for(var e=n.length,r=f.prepareBeginningIndexes(n),a=[],l=r[0],i=0,v=0;v<e;++v)l>v?a[v]=l:(l=r[++i],a[v]=l===void 0?e:l);return a},prepareBitmask:function(n){for(var e=0,r=n.length-1;r>=0;--r){var a=n[r],l=a>=97&&a<=122?a-97:a>=48&&a<=57?26:a===32?27:a<=127?28:29;e|=1<<l}return e},cleanup:L,new:k};return f}var D=typeof Map=="function"?Map:function(){var u=Object.create(null);this.get=function(f){return u[f]},this.set=function(f,n){return u[f]=n,this},this.clear=function(){u=Object.create(null)}},M=new D,P=new D,B=[];B.total=0;var b=[],I=[];function L(){M.clear(),P.clear(),b=[],I=[]}function C(u){for(var f=-9007199254740991,n=u.length-1;n>=0;--n){var e=u[n];if(e!==null){var r=e.score;r>f&&(f=r)}}return f===-9007199254740991?null:f}function j(u,f){var n=u[f];if(n!==void 0)return n;var e=f;Array.isArray(f)||(e=f.split("."));for(var r=e.length,a=-1;u&&++a<r;)u=u[e[a]];return u}function F(u){return typeof u=="object"}var X=function(){var u=[],f=0,n={};function e(){for(var r=0,a=u[r],l=1;l<f;){var i=l+1;r=l,i<f&&u[i].score<u[l].score&&(r=i),u[r-1>>1]=u[r],l=1+(r<<1)}for(var v=r-1>>1;r>0&&a.score<u[v].score;v=(r=v)-1>>1)u[r]=u[v];u[r]=a}return n.add=function(r){var a=f;u[f++]=r;for(var l=a-1>>1;a>0&&r.score<u[l].score;l=(a=l)-1>>1)u[a]=u[l];u[a]=r},n.poll=function(){if(f!==0){var r=u[0];return u[0]=u[--f],e(),r}},n.peek=function(r){if(f!==0)return u[0]},n.replaceTop=function(r){u[0]=r,e()},n},_=X();return k()})})(H);var O=H.exports;const V=U(O);function J(m,...x){const k=m.name||m;console.log(`%c${k}`,"color: #0f0;",...x)}J.error=function(m,...x){const k=m.name||m;console.log(`%c${k}`,"color: #f00;",...x)};const Q=new Map;function R(m){if(Q.has(m))return Q.get(m);let x=fetch(m).then(k=>k.json());return Q.set(m,x),x}const W=new Set,G=new Set;function re(){let m=[],x,k;return{find:M};function M(P){x&&x.cancel(),k=P;const B=P[0];let b=!1;if(!W.has(B)){const I=R(`${q.namesEndpoint}/${B}.json`).then(L=>{if(L.forEach(C=>{G.has(C[0])||(m.push({name:C[0],lat:C[1],lon:C[2],id:C[3]}),G.add(C[0]))}),W.add(B),!(b||k!==P))return M(P)}).catch(L=>{J.error("FuzzySearch","Failed to fetch index for "+B,L)});return I.cancel=()=>{b=!0},I}return x=V.goAsync(P,m,{limit:10,key:"name"}),x.then(I=>{if(!b)return I.map(L=>({html:V.highlight(L,"<b>","</b>"),text:L.target,lat:L.obj.lat,lon:L.obj.lon,id:L.obj.id}))})}}export{re as default};
//# sourceMappingURL=createFuzzySearcher-44227a86.js.map
