import{a as Z,g as U,c as q}from"./config-978035c8.js";var H={exports:{}};(function(m){(function(x,w){m.exports?m.exports=w():x.fuzzysort=w()})(Z,function(){function w(u){var f={single:function(n,r,e){if(n=="farzher")return{target:"farzher was here (^-^*)/",score:0,indexes:[0,1,2,3,4,5,6]};if(!n)return null;var a=f.getPreparedSearch(n),l=a.lowerCodes;if(!r)return null;F(r)||(r=f.getPrepared(r));var i=a.bitmask;return(i&r._bitmask)!=i?null:f.algorithm(l,r,n.toLowerCase())},go:function(n,r,e){if(n=="farzher")return[{target:"farzher was here (^-^*)/",score:0,indexes:[0,1,2,3,4,5,6],obj:r?r[0]:null}];if(!n)return e&&e.all||u&&u.all?f.all(n,r,e):B;var a=f.getPreparedSearch(n),l=a.lowerCodes;l[0];var i=a.bitmask,v=n.toLowerCase(),o=e&&e.threshold||u&&u.threshold||-9007199254740991,d=e&&e.limit||u&&u.limit||9007199254740991,t=0,s=0,L=r.length;if(e&&e.keys)for(var E=e.scoreFn||A,y=e.keys,T=y.length,p=L-1;p>=0;--p){for(var z=r[p],k=new Array(T),h=T-1;h>=0;--h){var N=y[h],c=j(z,N);if(!c){k[h]=null;continue}F(c)||(c=f.getPrepared(c)),(i&c._bitmask)!=i?k[h]=null:k[h]=f.algorithm(l,c,v)}k.obj=z;var C=E(k);C!==null&&(C<o||(k.score=C,t<d?(_.add(k),++t):(++s,C>_.peek().score&&_.replaceTop(k))))}else if(e&&e.key)for(var N=e.key,p=L-1;p>=0;--p){var z=r[p],c=j(z,N);if(c){if(F(c)||(c=f.getPrepared(c)),(i&c._bitmask)!=i)var g=null;else var g=f.algorithm(l,c,v);g!==null&&(g.score<o||(g={target:g.target,_targetLower:"",_targetLowerCodes:null,_nextBeginningIndexes:null,_bitmask:0,score:g.score,indexes:g.indexes,obj:z},t<d?(_.add(g),++t):(++s,g.score>_.peek().score&&_.replaceTop(g))))}}else for(var p=L-1;p>=0;--p){var c=r[p];if(c){if(F(c)||(c=f.getPrepared(c)),(i&c._bitmask)!=i)var g=null;else var g=f.algorithm(l,c,v);g!==null&&(g.score<o||(t<d?(_.add(g),++t):(++s,g.score>_.peek().score&&_.replaceTop(g))))}}if(t===0)return B;for(var $=new Array(t),p=t-1;p>=0;--p)$[p]=_.poll();return $.total=t+s,$},goAsync:function(n,r,e){var a=new Promise(function(l,i){l(f.go(n,r,e))});return a.cancel=function(){},a},all:function(n,r,e){var a=[];a.total=r.length;var l=e&&e.limit||u&&u.limit||9007199254740991;if(e&&e.keys)for(var i=0;i<r.length;i++){for(var v=r[i],o=new Array(e.keys.length),d=e.keys.length-1;d>=0;--d){var t=j(v,e.keys[d]);if(!t){o[d]=null;continue}F(t)||(t=f.getPrepared(t)),t.score=-9007199254740991,o[d]=t}if(o.obj=v,o.score=-9007199254740991,a.push(o),a.length>=l)return a}else if(e&&e.key)for(var i=0;i<r.length;i++){var v=r[i],t=j(v,e.key);if(t){F(t)||(t=f.getPrepared(t)),t.score=-9007199254740991;var s=t;if(s={target:s.target,_targetLower:"",_targetLowerCodes:null,_nextBeginningIndexes:null,_bitmask:0,score:t.score,indexes:null,obj:v},a.push(s),a.length>=l)return a}}else for(var i=0;i<r.length;i++){var t=r[i];if(t&&(F(t)||(t=f.getPrepared(t)),t.score=-9007199254740991,a.push(t),a.length>=l))return a}return a},highlight:function(n,r,e){if(typeof r=="function")return f.highlightCallback(n,r);if(n===null)return null;r===void 0&&(r="<b>"),e===void 0&&(e="</b>");for(var a="",l=0,i=!1,v=n.target,o=v.length,d=n.indexes,t=0;t<o;++t){var s=v[t];if(d[l]===t){if(++l,i||(i=!0,a+=r),l===d.length){a+=s+e+v.substr(t+1);break}}else i&&(i=!1,a+=e);a+=s}return a},highlightCallback:function(t,r){if(t===null)return null;for(var e=t.target,a=e.length,l=t.indexes,i="",v=0,o=0,d=!1,t=[],s=0;s<a;++s){var L=e[s];if(l[o]===s){if(++o,d||(d=!0,t.push(i),i=""),o===l.length){i+=L,t.push(r(i,v++)),i="",t.push(e.substr(s+1));break}}else d&&(d=!1,t.push(r(i,v++)),i="");i+=L}return t},prepare:function(n){n||(n="");var r=f.prepareLowerCodes(n);return{target:n,_targetLower:n.toLowerCase(),_targetLowerCodes:r,_nextBeginningIndexes:null,_bitmask:f.prepareBitmask(r),score:null,indexes:[0],obj:null}},prepareSlow:function(n){return f.prepare(n)},prepareSearch:function(n){n||(n="");var r=f.prepareLowerCodes(n);return{lowerCodes:r,bitmask:f.prepareBitmask(r)}},getPrepared:function(n){if(n.length>999)return f.prepare(n);var r=M.get(n);return r!==void 0||(r=f.prepare(n),M.set(n,r)),r},getPreparedSearch:function(n){if(n.length>999)return f.prepareSearch(n);var r=P.get(n);return r!==void 0||(r=f.prepareSearch(n),P.set(n,r)),r},algorithm:function(n,r,e){for(var a=n[0],l=r._targetLowerCodes,i=n.length,v=l.length,s=0,o=0,d=0;;){var t=a===l[o];if(t){if(b[d++]=o,++s,s===i)break;a=n[s]}if(++o,o>=v)return null}var s=0,L=!1,E=0,y=r._nextBeginningIndexes;y===null&&(y=r._nextBeginningIndexes=f.prepareNextBeginningIndexes(r.target)),o=b[0]===0?0:y[b[0]-1];var T=0;if(o!==v)for(;;)if(o>=v){if(s<=0||(++T,T>200))break;--s;var p=I[--E];o=y[p]}else{var t=n[s]===l[o];if(t){if(I[E++]=o,++s,s===i){L=!0;break}++o}else o=y[o]}var z=r._targetLower.indexOf(e,b[0]),k=~z;if(k&&!L)for(var h=0;h<d;++h)b[h]=z+h;var N=!1;k&&(N=r._nextBeginningIndexes[z-1]==z);{if(L)var c=I,C=E;else var c=b,C=d;for(var g=0,$=0,h=i-1;h>=1;--h)c[h]-c[h-1]!==1&&(g-=c[h],++$);var Y=c[i-1]-c[0]-(i-1);if(g-=Y*$,c[0]!==0&&(g-=c[0]*10),!L)g*=1e3;else{for(var K=1,h=y[0];h<v;h=y[h])++K;K>24&&(g*=(K-24)*10)}k&&(g/=10),N&&(g/=10),g-=v-i,r.score=g,r.indexes=new Array(C);for(var h=C-1;h>=0;--h)r.indexes[h]=c[h];return r}},prepareLowerCodes:function(n){for(var r=n.length,e=[],a=n.toLowerCase(),l=0;l<r;++l)e[l]=a.charCodeAt(l);return e},prepareBeginningIndexes:function(n){for(var r=n.length,e=[],a=0,l=!1,i=!1,v=0;v<r;++v){var o=n.charCodeAt(v),d=o>=65&&o<=90,t=d||o>=97&&o<=122||o>=48&&o<=57,s=d&&!l||!i||!t;l=d,i=t,s&&(e[a++]=v)}return e},prepareNextBeginningIndexes:function(n){for(var r=n.length,e=f.prepareBeginningIndexes(n),a=[],l=e[0],i=0,v=0;v<r;++v)l>v?a[v]=l:(l=e[++i],a[v]=l===void 0?r:l);return a},prepareBitmask:function(n){for(var r=0,e=n.length-1;e>=0;--e){var a=n[e],l=a>=97&&a<=122?a-97:a>=48&&a<=57?26:a===32?27:a<=127?28:29;r|=1<<l}return r},cleanup:S,new:w};return f}var D=typeof Map=="function"?Map:function(){var u=Object.create(null);this.get=function(f){return u[f]},this.set=function(f,n){return u[f]=n,this},this.clear=function(){u=Object.create(null)}},M=new D,P=new D,B=[];B.total=0;var b=[],I=[];function S(){M.clear(),P.clear(),b=[],I=[]}function A(u){for(var f=-9007199254740991,n=u.length-1;n>=0;--n){var r=u[n];if(r!==null){var e=r.score;e>f&&(f=e)}}return f===-9007199254740991?null:f}function j(u,f){var n=u[f];if(n!==void 0)return n;var r=f;Array.isArray(f)||(r=f.split("."));for(var e=r.length,a=-1;u&&++a<e;)u=u[r[a]];return u}function F(u){return typeof u=="object"}var X=function(){var u=[],f=0,n={};function r(){for(var e=0,a=u[e],l=1;l<f;){var i=l+1;e=l,i<f&&u[i].score<u[l].score&&(e=i),u[e-1>>1]=u[e],l=1+(e<<1)}for(var v=e-1>>1;e>0&&a.score<u[v].score;v=(e=v)-1>>1)u[e]=u[v];u[e]=a}return n.add=function(e){var a=f;u[f++]=e;for(var l=a-1>>1;a>0&&e.score<u[l].score;l=(a=l)-1>>1)u[a]=u[l];u[a]=e},n.poll=function(){if(f!==0){var e=u[0];return u[0]=u[--f],r(),e}},n.peek=function(e){if(f!==0)return u[0]},n.replaceTop=function(e){u[0]=e,r()},n},_=X();return w()})})(H);var O=H.exports;const V=U(O);function J(m,...x){const w=m.name||m;console.log(`%c${w}`,"color: #0f0;",...x)}J.error=function(m,...x){const w=m.name||m;console.log(`%c${w}`,"color: #f00;",...x)};const Q=new Map;function R(m){if(Q.has(m))return Q.get(m);let x=fetch(m).then(w=>w.json());return Q.set(m,x),x}const W=new Set,G=new Set;function er(){let m=[],x,w;return{find:M};function M(P){x&&x.cancel(),w=P;const B=P[0];let b=!1;if(!W.has(B)){const I=R(`${q.namesEndpoint}/${B}.json`).then(S=>{if(S.forEach(A=>{G.has(A[0])||(m.push({name:A[0],lat:A[1],lon:A[2]}),G.add(A[0]))}),W.add(B),!(b||w!==P))return M(P)}).catch(S=>{J.error("FuzzySearch","Failed to fetch index for "+B,S)});return I.cancel=()=>{b=!0},I}return x=V.goAsync(P,m,{limit:10,key:"name"}),x.then(I=>{if(!b)return I.map(S=>({html:V.highlight(S,"<b>","</b>"),text:S.target,lat:S.obj.lat,lon:S.obj.lon}))})}}export{er as default};
//# sourceMappingURL=createFuzzySearcher-5669717d.js.map
